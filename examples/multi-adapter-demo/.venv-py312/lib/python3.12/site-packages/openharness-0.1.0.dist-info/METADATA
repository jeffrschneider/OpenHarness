Metadata-Version: 2.4
Name: openharness
Version: 0.1.0
Summary: Universal API client for AI agent harnesses
Project-URL: Homepage, https://github.com/jeffrschneider/OpenHarness
Project-URL: Documentation, https://jeffrschneider.github.io/OpenHarness/
Project-URL: Repository, https://github.com/jeffrschneider/OpenHarness
Author: Open Harness Contributors
License-Expression: MIT
Keywords: agents,ai,claude,langchain,letta,llm,openharness
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Typing :: Typed
Requires-Python: >=3.10
Requires-Dist: httpx-sse>=0.4.0
Requires-Dist: httpx>=0.25.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: websockets>=12.0
Provides-Extra: dev
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Requires-Dist: ruff>=0.1.0; extra == 'dev'
Description-Content-Type: text/markdown

# openharness

Universal API client for AI agent harnesses. Build once, run on Claude, Goose, LangChain, Letta, and more.

## Installation

```bash
pip install openharness
```

## Quick Start

```python
import asyncio
from openharness import OpenHarnessClient, ExecuteRequest

async def main():
    async with OpenHarnessClient(
        base_url="https://api.harness.example.com/v1",
        api_key="your-api-key",
    ) as client:
        # Execute a prompt
        result = await client.execute(ExecuteRequest(
            message="What is 2 + 2?",
        ))
        print(result.response)

asyncio.run(main())
```

## Streaming

```python
from openharness import OpenHarnessClient, ExecuteRequest

async with OpenHarnessClient(base_url="...", api_key="...") as client:
    async for event in client.execute_stream(ExecuteRequest(
        message="Write a haiku about Python",
    )):
        if event.type == "text":
            print(event.content, end="", flush=True)
        elif event.type == "done":
            print(f"\n\nTokens: {event.usage.total_tokens}")
```

## Using Adapters

Adapters connect to specific harness implementations:

```python
from openharness import AdapterRegistry
from openharness_letta import LettaAdapter  # hypothetical

# Register adapters
registry = AdapterRegistry()
registry.register(LettaAdapter(api_key="..."))

# Use an adapter
adapter = registry.get("letta")
result = await adapter.execute(ExecuteRequest(
    message="Remember that my favorite color is blue",
))
```

## Building an Adapter

```python
from openharness import (
    HarnessAdapter,
    AdapterCapabilities,
    AdapterExecutionResult,
    ExecuteRequest,
    ExecutionEvent,
    TextEvent,
    DoneEvent,
)
from typing import AsyncIterator

class MyAdapter(HarnessAdapter):
    @property
    def id(self) -> str:
        return "my-harness"

    @property
    def name(self) -> str:
        return "My Harness"

    @property
    def version(self) -> str:
        return "1.0.0"

    @property
    def capabilities(self) -> AdapterCapabilities:
        return AdapterCapabilities(
            execution=True,
            streaming=True,
        )

    async def execute(
        self,
        request: ExecuteRequest,
        **options,
    ) -> AdapterExecutionResult:
        # Your implementation here
        return AdapterExecutionResult(
            output="Hello from my harness!",
        )

    async def execute_stream(
        self,
        request: ExecuteRequest,
        **options,
    ) -> AsyncIterator[ExecutionEvent]:
        yield TextEvent(content="Hello ")
        yield TextEvent(content="from my harness!")
        yield DoneEvent()
```

## API Domains

The client provides access to all 13 Open Harness API domains:

| Domain | Description |
|--------|-------------|
| **Harnesses** | Discover available harnesses |
| **Agents** | Create, update, delete agents |
| **Skills** | Install and manage skills |
| **Tools** | List and invoke tools |
| **MCP** | Connect to MCP servers |
| **Execution** | Run prompts (sync/stream) |
| **Sessions** | Manage conversations |
| **Memory** | Memory blocks and archival |
| **Subagents** | Spawn and manage subagents |
| **Files** | File operations |
| **Hooks** | Pre/post execution hooks |
| **Planning** | Todo management |
| **Models** | Model selection |

## Client Methods

### Execution

```python
# Synchronous execution
result = await client.execute(ExecuteRequest(message="Hello"))

# Streaming execution
async for event in client.execute_stream(ExecuteRequest(message="Hello")):
    ...

# Get execution status
execution = await client.get_execution(execution_id)

# Cancel execution
await client.cancel_execution(execution_id)
```

### Sessions

```python
# Create session
session = await client.create_session(CreateSessionRequest(
    name="My Session",
    system_prompt="You are a helpful assistant",
))

# Get session history
history = await client.get_session_history(session.id)

# Fork session
forked = await client.fork_session(session.id)
```

### Memory

```python
# Create memory block
block = await client.create_memory_block(CreateMemoryBlockRequest(
    type=MemoryBlockType.CORE,
    label="user_preferences",
    content="User prefers concise responses",
))

# Search archival memory
results = await client.search_archive("favorite color")
```

### MCP

```python
# Connect to MCP server
server = await client.connect_mcp_server(ConnectMcpRequest(
    name="filesystem",
    command="npx",
    args=["-y", "@anthropic-ai/mcp-server-filesystem", "/tmp"],
))

# List MCP tools
tools = await client.list_mcp_tools(server.id)
```

## Type Safety

All types are defined with Pydantic for full type safety:

```python
from openharness import (
    Agent,
    CreateAgentRequest,
    AgentState,
)

# Type-safe request
request = CreateAgentRequest(
    name="My Agent",
    system_prompt="You are helpful",
    model="claude-sonnet-4-20250514",
)

# Response is fully typed
agent: Agent = await client.create_agent(request)
print(agent.id, agent.state)
```

## Error Handling

```python
from openharness import (
    TransportError,
    AuthenticationError,
    RateLimitError,
    ConnectionError,
)

try:
    result = await client.execute(request)
except AuthenticationError:
    print("Invalid API key")
except RateLimitError as e:
    print(f"Rate limited, retry after {e.retry_after}s")
except ConnectionError:
    print("Failed to connect")
except TransportError as e:
    print(f"Request failed: {e.status_code}")
```

## Configuration

```python
from openharness import OpenHarnessClient, RestTransport

# Custom transport
transport = RestTransport(
    base_url="https://api.example.com/v1",
    api_key="...",
    timeout=60.0,
)

client = OpenHarnessClient(transport=transport)
```

## License

MIT
